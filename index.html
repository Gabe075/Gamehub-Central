<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GameHub Central — Final</title>
<meta name="description" content="GameHub Central — mods e apps" />
<style>
  :root{
    --bg:#0f0520; --accent1:#7c3aed; --accent2:#a78bfa; --muted:#cfcbe2; --text:#e9e6f7;
    --card-radius:12px; --maxw:1100px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:radial-gradient(ellipse at 10% 0%, rgba(124,58,237,0.12), transparent 10%),var(--bg);color:var(--text)}
  .wrap{max-width:var(--maxw);margin:18px auto;padding:0 14px}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:64px;height:64px;border-radius:12px;overflow:hidden;background:linear-gradient(135deg,var(--accent1),#5b21b6);display:grid;place-items:center}
  .logo img{width:100%;height:100%;object-fit:cover}
  h1{font-size:20px;margin:0}
  .actions{display:flex;gap:10px;align-items:center}
  .btn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;padding:10px 14px;border-radius:12px;border:0;cursor:pointer;text-decoration:none;font-weight:800}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);box-shadow:none}
  .search{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,0.02);padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,0.03)}
  .search input{background:transparent;border:0;outline:0;color:var(--text);width:260px;padding:6px 0}
  /* layout */
  .layout{display:flex;gap:20px}
  .maincol{flex:1}
  .sidecol{width:280px;min-width:220px}
  .highlight{padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(124,58,237,0.07), rgba(25,6,45,0.18));border:1px solid rgba(255,255,255,0.03);margin-bottom:14px}
  .list{display:flex;flex-direction:column;gap:12px}
  .card{display:flex;gap:12px;padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);align-items:center}
  .thumb{width:110px;height:90px;border-radius:10px;overflow:hidden;background:#0b0b0b;display:grid;place-items:center;flex-shrink:0}
  .thumb img{width:100%;height:100%;object-fit:cover}
  .info{flex:1}
  .title{font-weight:800;font-size:16px}
  .desc{color:var(--muted);font-size:13px;margin-top:6px}
  .meta{color:var(--muted);font-size:13px;margin-top:8px}
  .side-block{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);margin-bottom:12px}
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:90;padding:18px}
  .panel{width:920px;max-width:100%;max-height:92vh;overflow:auto;border-radius:12px;background:linear-gradient(180deg, rgba(10,8,12,0.98), rgba(20,14,28,0.98));padding:18px;border:1px solid rgba(255,255,255,0.04)}
  .hero{height:260px;border-radius:10px;overflow:hidden;background:#0a0a0a;display:flex;align-items:center;justify-content:center;color:var(--muted);margin-bottom:12px}
  @media (max-width:980px){ .layout{flex-direction:column} .sidecol{width:100%;order:2} .search input{width:140px} .card{flex-direction:column;align-items:flex-start} .thumb{width:100%;height:180px} }
</style>
</head>
<body>
  <script>
  // FORÇAR LIMPEZA DE SW, CACHE E STORAGE NO LOAD (GARANTE QUE NÃO HÁ RESÍDUOS)
  (function(){
    try{
      // limpar storages
      try{ localStorage.clear(); sessionStorage.clear(); }catch(e){/* ignore */}
      // unregister service workers
      if('serviceWorker' in navigator){
        navigator.serviceWorker.getRegistrations().then(regs=>{
          regs.forEach(r=> r.unregister().catch(()=>{}));
        }).catch(()=>{});
      }
      // clear caches (if available)
      if('caches' in window){
        caches.keys().then(keys=> Promise.all(keys.map(k=>caches.delete(k)))).catch(()=>{});
      }
      // prevent old pages from using snapshot caches
      if(location.search.indexOf('v=')===-1){
        // do nothing — caller may add ?v=timestamp manually
      }
    }catch(e){}
  })();
  </script>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo"><img src="https://raw.githubusercontent.com/Gabe075/Imagem/refs/heads/main/IMG-20251116-WA0008.jpg" alt="logo"></div>
        <div><h1>GameHub Central</h1><div style="color:var(--muted);font-size:13px">Mods, apps e utilitários</div></div>
      </div>

      <div class="actions">
        <div class="search"><svg width="16" height="16" viewBox="0 0 24 24" style="opacity:.7;margin-right:6px"><path fill="currentColor" d="M9.5 3a6.5 6.5 0 104.47 11.13l4.95 4.95 1.41-1.41-4.95-4.95A6.5 6.5 0 009.5 3zM5 9.5A4.5 4.5 0 119.5 14 4.5 4.5 0 015 9.5z"/></svg><input id="q" placeholder="Pesquisar por nome, descrição ou tag"></div>

        <select id="filter" class="select" title="Filtrar">
          <option value="all">Todos</option><option value="games">Jogos</option><option value="mods">Mods</option><option value="apps">Apps</option><option value="tools">Ferramentas</option>
        </select>

        <!-- MESMO ESTILO PARA INSTAGRAM E WHATSAPP -->
        <a id="instaBtn" class="btn" href="https://www.instagram.com/gabe.am29?igsh=bDc4dHl3ZGNhcm4y" target="_blank">Instagram</a>
        <a id="whatsBtn" class="btn" href="https://chat.whatsapp.com/Kma7lW0piMU8njwKvqo5e1?mode=hqrc" target="_blank">WhatsApp</a>
      </div>
    </header>

    <main class="layout">
      <section class="maincol">
        <div id="highlight" class="highlight" style="display:none"></div>
        <div id="list" class="list"></div>
      </section>

      <aside class="sidecol">
        <div class="side-block"><h4>Categorias</h4><div id="cats"></div></div>
        <div class="side-block"><h4>Destaques</h4><div id="side-high"></div></div>
        <div class="side-block"><h4>Links</h4><a class="btn" href="https://chat.whatsapp.com/Kma7lW0piMU8njwKvqo5e1?mode=hqrc" target="_blank">Entrar no grupo</a></div>
      </aside>
    </main>
  </div>

  <!-- detail modal -->
  <div id="overlay" class="overlay" aria-hidden="true"><div class="panel"><button id="close" class="btn ghost" style="position:absolute;right:18px;top:18px">✕</button><div id="detail"></div></div></div>

<script>
/* Carrega apps.js sem cache e injeta (única fonte de conteúdo) */
(async function(){
  try{
    const res = await fetch('apps.js?t=' + Date.now(), { cache: 'no-store' });
    if(!res.ok) throw new Error('apps.js não encontrado');
    const js = await res.text();
    const blob = new Blob([js], { type: 'text/javascript' });
    const url = URL.createObjectURL(blob);
    const s = document.createElement('script'); s.src = url;
    s.onload = ()=>{ URL.revokeObjectURL(url); boot(); };
    document.body.appendChild(s);
  }catch(e){
    console.error('Falha ao carregar apps.js', e);
    const s = document.createElement('script'); s.src='apps.js'; s.onload=boot; document.body.appendChild(s);
  }
})();

function esc(s){ return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }
function getApps(){ return Array.isArray(window.APPS) ? window.APPS.slice().sort((a,b)=> (b.highlight?1:0)-(a.highlight?1:0) || (b.timestamp||0)-(a.timestamp||0)) : []; }

function boot(){
  renderAll();
  attachSearch();
  document.getElementById('filter').addEventListener('change', ()=> renderAll());
  // hash route
  if(location.hash.startsWith('#/app/')) openDetail(decodeURIComponent(location.hash.replace('#/app/','')));
}

function renderAll(){
  const apps = getApps();
  renderHighlight(apps);
  renderList(apps);
  renderSide(apps);
}

function renderHighlight(apps){
  const first = apps.find(a=>a.highlight) || apps[0];
  if(!first){ document.getElementById('highlight').style.display='none'; return; }
  const el = document.getElementById('highlight');
  el.style.display='block';
  el.innerHTML = `
    <div style="display:flex;gap:12px;align-items:center">
      <div style="width:260px;height:140px;border-radius:10px;overflow:hidden">${first.icon?'<img src="'+esc(first.icon)+'" style="width:100%;height:100%;object-fit:cover">':''}</div>
      <div>
        <div style="font-weight:800;font-size:18px">${esc(first.title)}</div>
        <div style="color:var(--muted);margin-top:8px">${esc(first.desc||'')}</div>
        <div style="margin-top:12px"><a class="btn" href="#/app/${encodeURIComponent(first.slug)}" onclick="event.preventDefault();openDetail('${esc(first.slug)}')">Abrir</a>
        <a class="btn" href="${esc(first.download||('files/'+first.slug+'.apk'))}" target="_blank" style="margin-left:8px">Download</a></div>
      </div>
    </div>
  `;
}

function renderList(apps){
  const list = document.getElementById('list');
  if(!apps.length){ list.innerHTML = '<div style="color:var(--muted)">Nenhum app encontrado.</div>'; return; }
  const filtered = (document.getElementById('filter').value === 'all') ? apps : apps.filter(a=> (a.tag||'') === document.getElementById('filter').value);
  list.innerHTML = filtered.map(a=>`
    <div class="card" data-slug="${esc(a.slug)}">
      <div class="thumb">${a.icon?'<img src="'+esc(a.icon)+'">':''}</div>
      <div class="info">
        <div class="title">${esc(a.title)} ${a.badges?'<span style="margin-left:8px;padding:6px 8px;border-radius:999px;background:linear-gradient(90deg,var(--accent1),var(--accent2));font-weight:800;font-size:12px;color:#fff">'+esc((a.badges||[]).join(', '))+'</span>':''}</div>
        <div class="desc">${esc(a.desc||'')}</div>
        <div class="meta">${esc(a.version||'')} · ${esc(a.size||'')}</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
        <a class="btn" href="${esc(a.download||('files/'+a.slug+'.apk'))}" target="_blank">Download</a>
        <a class="btn ghost" href="#/app/${encodeURIComponent(a.slug)}" onclick="event.preventDefault();openDetail('${esc(a.slug)}')" style="margin-top:6px">Abrir</a>
      </div>
    </div>
  `).join('');
  // attach card clicks (except link)
  document.querySelectorAll('.card').forEach(c=>{
    c.addEventListener('click', e=>{
      if(e.target.closest('a')) return;
      openDetail(c.dataset.slug);
    });
  });
}

function renderSide(apps){
  const cats = Array.from(new Set(apps.map(a=>a.tag).filter(Boolean)));
  document.getElementById('cats').innerHTML = cats.map(c=>`<a href="#" data-cat="${esc(c)}" onclick="event.preventDefault();document.getElementById('filter').value='${esc(c)}'; renderAll();">${esc(c)}</a>`).join('');
  document.getElementById('side-high').innerHTML = apps.filter(a=>a.highlight).slice(0,6).map(h=>`<div style="margin-bottom:8px"><a href="#/app/${encodeURIComponent(h.slug)}" onclick="event.preventDefault();openDetail('${esc(h.slug)}')">${esc(h.title)}</a></div>`).join('');
}

function attachSearch(){
  const input = document.getElementById('q');
  input.addEventListener('input', debounce(()=>{
    const q = input.value.trim().toLowerCase();
    const apps = getApps().filter(a=>{
      if(!q) return true;
      return (a.title+' '+(a.desc||'')+' '+(a.fullDesc||'')+' '+(a.tag||'')).toLowerCase().includes(q);
    });
    renderList(apps);
  },160));
}

function openDetail(slug){
  const app = getApps().find(a=>a.slug===slug);
  if(!app) return;
  const screens = (app.screenshots||[]).map(s=>'<img src="'+esc(s)+'" style="width:200px;height:120px;object-fit:cover;border-radius:8px;margin-right:8px">').join('');
  const dl = esc(app.download || ('files/' + app.slug + '.apk'));
  const html = `
    <div class="hero">${screens || esc(app.title)}</div>
    <h2 style="margin-top:12px">${esc(app.title)}</h2>
    <p style="color:var(--muted)">${esc(app.desc||'')}</p>
    <p style="color:var(--muted)"><strong>Versão:</strong> ${esc(app.version||'')} · <strong>Tamanho:</strong> ${esc(app.size||'')}</p>
    <div style="display:flex;gap:10px;margin-top:12px">
      <a class="btn" href="${dl}" target="_blank">Baixar</a>
      <button id="copyLink" class="btn ghost">Copiar link</button>
    </div>
    <h3 style="margin-top:16px">Descrição</h3>
    <p style="color:var(--muted)">${esc(app.fullDesc || app.desc || '')}</p>
  `;
  document.getElementById('detail').innerHTML = html;
  document.getElementById('overlay').style.display = 'flex';
  document.getElementById('overlay').setAttribute('aria-hidden','false');
  const copyBtn = document.getElementById('copyLink');
  if(copyBtn){
    copyBtn.addEventListener('click', async ()=>{
      const url = location.origin + location.pathname + '#/app/' + encodeURIComponent(app.slug);
      try{ await navigator.clipboard.writeText(url); copyBtn.textContent='Copiado!'; setTimeout(()=>copyBtn.textContent='Copiar link',1500); }catch(e){}
    });
  }
  history.pushState({slug}, '', '#/app/' + encodeURIComponent(app.slug));
}
document.getElementById('close').addEventListener('click', ()=>{ document.getElementById('overlay').style.display='none'; history.pushState({}, '', '#'); });

function debounce(fn,t=160){ let to; return (...a)=>{ clearTimeout(to); to=setTimeout(()=>fn(...a),t); }; }
</script>

</body>
</html>
